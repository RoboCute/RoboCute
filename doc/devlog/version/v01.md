# Robocute V0.1 MVP

- start-date 

Robocute V0.1 的目标是最小可用原型 (Minimum Valuable Prototype)，旨在最快速地将原始构想组件拼接起来（Python Server + LuisaCompute Backend + Qt UI），实现一个本地3D版本的ComfyUI程序

主要的工作量集中在
- 技术选型
  - 探索Qt和LuisaCompute是否可以比较容易地使用QRhi进行嵌入
  - 探索ComfyUI-Like的前后端框架与Qt的NodeEditor框架是否能组合
  - 探索一套基于python反射和xmake的高效codebase开发框架
- Codebase部分
- Editor部分
- NodeGraph原型部分

# 最小价值产品(Minimal Valuable Product)

## 核心目标

通过**编辑器驱动的拖放式交互**跑通完整的算法构建和可视化pipeline：

1. **场景准备**: PythonServer加载场景和资源，并注册节点，在最小价值产品中，我们将会生成指定的Entity按给定的角速度绕给定的原点和半径旋转的给定帧数动画
2. **拖放式连接**: 从编辑器场景视图拖拽Entity到NodeGraph节点输入端口
3. **节点图构建**: 在NodeGraph中连接算法节点（如旋转动画生成器）
4. **执行计算**: PythonServer从Editor中同步初始值（当前场景），执行节点图，生成AnimSequence结果
5. **结果展示**: 在Result面板中，能找到从PythonServer端同步过来的Transform动画，点击之后出现时间轴和播放/暂停按钮，点击播放可以播放结果动画

## Step 1

纯Editor部分功能

- 创建初始场景
- 连接节点图
- 播放结果动画

## Implementation Status

### Completed Features

#### Python Backend (Phase 1-4)
- ✅ Animation data structures (AnimationKeyframe, AnimationSequence, AnimationClip)
- ✅ Scene animation storage and management
- ✅ SceneContext for read-only scene access in nodes
- ✅ Node execution with scene context support
- ✅ EntityInput, RotationAnimation, AnimationOutput nodes
- ✅ Animation REST API endpoints (/animations, /animations/{name})
- ✅ EditorService animation synchronization
- ✅ Graph execution with scene context

#### C++ Editor (Phase 5-8)
- ✅ Animation data structures (AnimationClip, AnimationSequence, AnimationKeyframe)
- ✅ SceneSync animation parsing from JSON
- ✅ ResultPanel widget for displaying animations
- ✅ AnimationPlayer widget with timeline and playback controls
- ✅ HttpClient animation fetch methods
- ✅ SceneSyncManager fetches animations during sync
- ✅ AnimationPlaybackManager for applying animation transforms
- ✅ EditorScene animation transform override system

#### Integration (Phase 9)
- ✅ MainWindow integration of ResultPanel and AnimationPlayer
- ✅ Animation selection and playback pipeline
- ✅ Frame-by-frame animation scrubbing
- ✅ Automatic animation looping

### Manual Testing Checklist

#### Automated Test
```bash
# Run the automated test script
python samples/mvp_test.py
```

#### Manual Editor Test
1. **Start Server**
   ```bash
   python main.py
   ```
   - Server should start on port 5555
   - Should see "Robot" entity registered
   - Animation nodes should be registered

2. **Start Editor**
   - Launch RoboCute Editor (editor.exe)
   - Editor should auto-connect to localhost:5555
   - Should see "Connected to scene server" in status bar

3. **Verify Scene**
   - Scene Hierarchy panel should show "Robot" entity
   - Click on Robot to see transform component in Details panel
   - 3D viewport should show mesh (if mesh loaded)

4. **Create Animation via Node Graph**
   - Open Node Graph panel (bottom dock)
   - Add nodes:
     - EntityInput node (set entity_id = 1)
     - RotationAnimation node
       - Connect EntityInput.entity → RotationAnimation.entity
       - Set parameters: radius=2.0, angular_velocity=1.0, duration_frames=120, fps=30
     - AnimationOutput node
       - Connect RotationAnimation.animation → AnimationOutput.animation
       - Set name = "rotation_test"
   - Click "Execute Graph" button

5. **Verify Result**
   - Result Panel (right dock, bottom) should update
   - Should show "rotation_test (120 frames, 30.0 fps)"
   - Status should show "1 animation(s)" in green

6. **Play Animation**
   - Click on "rotation_test" in Result Panel
   - AnimationPlayer widget should appear below
   - Should show "Animation: rotation_test"
   - Timeline slider should be enabled (0-120 frames)
   - Click "Play" button
   - Entity should rotate around origin in viewport
   - Frame counter should update: "Frame: X / 120"

7. **Interactive Playback**
   - While playing, animation should loop automatically
   - Click "Pause" to stop
   - Drag timeline slider to scrub through frames
   - Entity transform should update immediately
   - Status bar shows current frame number

### Known Limitations (MVP)
- No interpolation between keyframes (nearest-frame sampling)
- Manual entity ID input (no drag-drop from Scene Hierarchy)
- Animation only affects single entity per sequence
- No animation editing in Editor (create via nodes only)
- Simple circular motion only (XZ plane rotation)

### Next Steps (Post-MVP)
- Implement drag-drop Entity to NodeGraph
- Add keyframe interpolation (linear/cubic)
- Support multiple animation layers
- Animation timeline editing in Editor
- Save/load animation clips as files
- More animation generator nodes (physics sim, paths, etc.)

